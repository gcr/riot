<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>riot: Distributed computing for the masses</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="/" class="tocviewselflink" pltdoc="x"><span style="font-weight: bold">riot</span>:<span class="mywbr"> </span> Distributed computing for the masses</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="/#(part._.T.O.D.O)" class="tocviewlink" pltdoc="x">TODO</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="/#(part._.In_which_we_construct_a_networked_mapreduce_cluster_from_scratch_in_about_thirty_seconds)" class="tocviewlink" pltdoc="x">In which we construct a networked mapreduce cluster from scratch in
about thirty seconds</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="/#(part._.In_which_we_gain_significant_speedups_through_the_copious_application_of_spare_machinery)" class="tocviewlink" pltdoc="x">In which we gain significant speedups through the copious application of spare machinery</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="/#(part._.In_which_we_present_an_overview_and_clarity_is_achieved)" class="tocviewlink" pltdoc="x">In which we present an overview and clarity is achieved</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="/#(part._restrictions)" class="tocviewlink" pltdoc="x">In which we dispel all manner of shenanigans and peculiarities about for/<span class="mywbr"> </span>work and do-<wbr></wbr>work</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="/#(part._.In_which_we_describe_the_numerous_kinds_of_workunits)" class="tocviewlink" pltdoc="x">In which we describe the numerous kinds of workunits</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="/#(part._lowlevel)" class="tocviewlink" pltdoc="x">In which we present a lower-<wbr></wbr>level client API for communicating with the tracker</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#(part._.T.O.D.O)" class="tocsubseclink" pltdoc="x">TODO</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#(part._.In_which_we_construct_a_networked_mapreduce_cluster_from_scratch_in_about_thirty_seconds)" class="tocsubseclink" pltdoc="x">In which we construct a networked mapreduce cluster from scratch in
about thirty seconds</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#(part._.In_which_we_gain_significant_speedups_through_the_copious_application_of_spare_machinery)" class="tocsubseclink" pltdoc="x">In which we gain significant speedups through the copious application of spare machinery</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#(part._.In_which_we_present_an_overview_and_clarity_is_achieved)" class="tocsubseclink" pltdoc="x">In which we present an overview and clarity is achieved</a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#(part._.The_master_program)" class="tocsubseclink" pltdoc="x">The master program</a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#(part._.The_tracker)" class="tocsubseclink" pltdoc="x">The tracker</a></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#(part._.The_workers)" class="tocsubseclink" pltdoc="x">The workers</a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#(part._restrictions)" class="tocsubseclink" pltdoc="x">In which we dispel all manner of shenanigans and peculiarities about for/<span class="mywbr"> </span>work and do-<wbr></wbr>work</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#(part._.In_which_we_describe_the_numerous_kinds_of_workunits)" class="tocsubseclink" pltdoc="x">In which we describe the numerous kinds of workunits</a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#(part._lowlevel)" class="tocsubseclink" pltdoc="x">In which we present a lower-<wbr></wbr>level client API for communicating with the tracker</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><h2><a name="(part._riot__.Distributed_computing_for_the_masses)"></a><span style="font-weight: bold">riot</span>: Distributed computing for the masses</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">gcr</p></span></div><p>Riot is a distributed computing system for racket. With Riot, you can run
parallel tasks on multiple machines accross the network with minimal changes to
your code.</p><p>You need a Racket that supports submodules. At the time of writing, only the
<a href="http://pre.racket-lang.org/installers/">nightly builds</a> will work.</p><table cellspacing="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.T.O.D.O)" class="toptoclink" pltdoc="x">1<span class="hspace">&nbsp;</span>TODO</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.In_which_we_construct_a_networked_mapreduce_cluster_from_scratch_in_about_thirty_seconds)" class="toptoclink" pltdoc="x">2<span class="hspace">&nbsp;</span>In which we construct a networked mapreduce cluster from scratch in
about thirty seconds</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.In_which_we_gain_significant_speedups_through_the_copious_application_of_spare_machinery)" class="toptoclink" pltdoc="x">3<span class="hspace">&nbsp;</span>In which we gain significant speedups through the copious application of spare machinery</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.In_which_we_present_an_overview_and_clarity_is_achieved)" class="toptoclink" pltdoc="x">4<span class="hspace">&nbsp;</span>In which we present an overview and clarity is achieved</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.The_master_program)" class="toclink" pltdoc="x">4.1<span class="hspace">&nbsp;</span>The master program</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.The_tracker)" class="toclink" pltdoc="x">4.2<span class="hspace">&nbsp;</span>The tracker</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.The_workers)" class="toclink" pltdoc="x">4.3<span class="hspace">&nbsp;</span>The workers</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._restrictions)" class="toptoclink" pltdoc="x">5<span class="hspace">&nbsp;</span>In which we dispel all manner of shenanigans and peculiarities about for/work and do-work</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._.In_which_we_describe_the_numerous_kinds_of_workunits)" class="toptoclink" pltdoc="x">6<span class="hspace">&nbsp;</span>In which we describe the numerous kinds of workunits</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="/#(part._lowlevel)" class="toptoclink" pltdoc="x">7<span class="hspace">&nbsp;</span>In which we present a lower-level client API for communicating with the tracker</a></p></td></tr></table><h3>1<tt>&nbsp;</tt><a name="(part._.T.O.D.O)"></a>TODO</h3><p>TODO: Ensure that workers actually exit when the tracker misbehaves.</p><p>TODO: Change server/start to just server</p><p>TODO: Progress reporting?</p><p>TODO: change error? to success?</p><h3>2<tt>&nbsp;</tt><a name="(part._.In_which_we_construct_a_networked_mapreduce_cluster_from_scratch_in_about_thirty_seconds)"></a>In which we construct a networked mapreduce cluster from scratch in
about thirty seconds</h3><ol><li><p><div class="SIntrapara">To get started, first start the tracker server. In a terminal, run:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ racket -p gcr/riot/server</span></span></p></td></tr></table></div></p></li><li><p><div class="SIntrapara">Parellel code looks like this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Save</span><span class="hspace">&nbsp;</span><span class="RktCmt">to</span><span class="hspace">&nbsp;</span><span class="RktCmt">simple-demo.rkt</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta">racket</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcGxhbmV0KSkp%0D%0A" class="RktStxLink" pltdoc="x">planet</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">gcr/riot</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZGVmaW5lKSkp%0D%0A" class="RktStxLink" pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9wcml2YXRl%0D%0AL2Jhc2Uucmt0IikgYyBpbi1yYW5nZSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">in-range</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBz%0D%0AbGVlcCkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">sleep</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;</span><span class="hspace">&nbsp;</span><span class="RktCmt">or</span><span class="hspace">&nbsp;</span><span class="RktCmt">some</span><span class="hspace">&nbsp;</span><span class="RktCmt">big</span><span class="hspace">&nbsp;</span><span class="RktCmt">task</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyAq%0D%0AKSkp%0D%0A" class="RktValLink" pltdoc="x">*</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">10</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgbW9kdWxlKykpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">module+</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">main</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">connect-to-riot-server!</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"localhost"</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9wcml2YXRl%0D%0AL21pc2Mucmt0IikgYyBkaXNwbGF5bG4pKSk%3D%0D%0A" class="RktValLink" pltdoc="x">displayln</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Note</span><span class="hspace">&nbsp;</span><span class="RktCmt">that</span><span class="hspace">&nbsp;</span><span class="RktCmt">(run)</span><span class="hspace">&nbsp;</span><span class="RktCmt">must</span><span class="hspace">&nbsp;</span><span class="RktCmt">be</span><span class="hspace">&nbsp;</span><span class="RktCmt">in</span><span class="hspace">&nbsp;</span><span class="RktCmt">a</span><span class="hspace">&nbsp;</span><span class="RktCmt">separate</span><span class="hspace">&nbsp;</span><span class="RktCmt">function--see</span><span class="hspace">&nbsp;</span><span class="RktCmt">below</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9wcml2YXRl%0D%0AL21pc2Mucmt0IikgYyBkaXNwbGF5bG4pKSk%3D%0D%0A" class="RktValLink" pltdoc="x">displayln</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"Complete"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></div></p><p>You just wrote the &ldquo;master&rdquo; program that hands out work and processes the
results. The <span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span><span class="stt"> </span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9zdHhjYXNlLXNjaGVtZS5ya3QiKSBjIC4uLikpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span> form acts just like <span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZm9yL2xpc3QpKSk%3D%0D%0A" class="RktStxLink" pltdoc="x">for/list</a></span>, but
it runs in parallell: <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> packages its body into &ldquo;workunits&rdquo;
that will be run by other worker processes. It will generate one workunit for
each iteration. (Using <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> is not the only way to control riot
and it has <a href="/#(part._restrictions)" pltdoc="x">restrictions and odd behavior</a>, but it is
the easiest.)</p><p><div class="SIntrapara">Go ahead and start your program:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ racket simple-demo.rkt</span></span></p></td></tr></table></div></p><p>The loop runs 10 times, so your program will register 10 units of work with the
tracker. It will then appear to freeze because there aren&rsquo;t any workers to run
the work yet. Once we make some workers, the tracker will assign workunits to
them and will return results back to your program once the workers finish.
Workers can even run on other machines; in these cases, the tracker will simply
send workunits accross the network. There&rsquo;s no difference between local and
networked workers, so commandeer your entire computer lab if you like.</p></li><li><p>Let&rsquo;s start some worker processes. If you want your workers to run on
other machines, copy <span class="stt">simple-demo.rkt</span> there.</p><p><div class="SIntrapara">From the same directory that contains <span class="stt">simple-demo.rkt</span>, run
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ racket -p gcr/riot/worker -- localhost</span></span></p></td></tr></table></div></p><p>where <span class="stt">localhost</span> is the hostname of the tracker server you ran earlier.
Once you start a worker, it will immediately start to process workunits. Once
all workunits are finished, the master program will un-freeze and the
<span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> form will return the results of each workunit to the caller.</p><p>Add as many workers as you like. The more workers you run, the faster your
program goes. If you kill a worker with Ctrl+C or subject it to some other
horrible fate, the tracker server should notice and will reassign abandoned
workunits to other workers.</p><p>If one of the workers throws an exception, the tracker will forward the
exception to <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span>, which will in turn will throw an exception with
a message about which worker caused the problem. Don&rsquo;t worry &#8212;<wbr></wbr> the tracker
remembers completed workunits after your program exits, so if you run your
program again, it will pick up where it left off.</p><p>If you change your program, be sure to copy the new version to all of the
workers and restart them all too. If you don&rsquo;t, they might complain (throw
exceptions) if you&rsquo;re lucky, or they just might give results generated from the
older code if you&rsquo;re unlucky. </p></li></ol><h3>3<tt>&nbsp;</tt><a name="(part._.In_which_we_gain_significant_speedups_through_the_copious_application_of_spare_machinery)"></a>In which we gain significant speedups through the copious application of spare machinery</h3><p>Her&rsquo;s an anecdote where I gained a 10x speedup by changing two lines of code
and borrowing five machines for an hour.</p><p>In this example, we find all compound dictionary words: words in
<span class="stt">/usr/share/dict/words</span> that are made by concatenating two other dictionary
words.</p><p>Here&rsquo;s some simple code to do that:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgbW9kLXBhdGggYyAicmFja2V0Iikp%0D%0A" class="RktModLink" pltdoc="x"><span class="RktSym">racket</span></a><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">dict.rkt</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcGxhbmV0KSkp%0D%0A" class="RktStxLink" pltdoc="x">planet</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">gcr/riot</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZGVmaW5lKSkp%0D%0A" class="RktStxLink" pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">List</span><span class="hspace">&nbsp;</span><span class="RktCmt">of</span><span class="hspace">&nbsp;</span><span class="RktCmt">words</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvc2V0LnJr%0D%0AdCIpIGMgZm9yL3NldCkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">for/set</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9wcml2YXRl%0D%0AL2Jhc2Uucmt0IikgYyBpbi1saXN0KSkp%0D%0A" class="RktValLink" pltdoc="x">in-list</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9maWxlLnJr%0D%0AdCIpIGMgZmlsZS0%2BbGluZXMpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">file-&gt;lines</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"/usr/share/dict/words"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">#:when</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyA%2B%0D%0APSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">&gt;=</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBz%0D%0AdHJpbmctbGVuZ3RoKSkp%0D%0A" class="RktValLink" pltdoc="x">string-length</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZGVmaW5lKSkp%0D%0A" class="RktStxLink" pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">word-combinations</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9wcml2YXRl%0D%0AL2Jhc2Uucmt0IikgYyBhcHBseSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">apply</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBh%0D%0AcHBlbmQpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">append</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;</span><span class="hspace">&nbsp;</span><span class="RktCmt">This</span><span class="hspace">&nbsp;</span><span class="RktCmt">flattens</span><span class="hspace">&nbsp;</span><span class="RktCmt">the</span><span class="hspace">&nbsp;</span><span class="RktCmt">list</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZm9yL2xpc3QpKSk%3D%0D%0A" class="RktStxLink" pltdoc="x">for/list</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">first-word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9zZXQucmt0%0D%0AIikgYyBpbi1zZXQpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">in-set</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZm9yL2xpc3QpKSk%3D%0D%0A" class="RktStxLink" pltdoc="x">for/list</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">second-word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9zZXQucmt0%0D%0AIikgYyBpbi1zZXQpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">in-set</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">#:when</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9zZXQucmt0%0D%0AIikgYyBzZXQtbWVtYmVyPykpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">set-member?</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBz%0D%0AdHJpbmctYXBwZW5kKSkp%0D%0A" class="RktValLink" pltdoc="x">string-append</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">first-word</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">second-word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBj%0D%0Ab25zKSkp%0D%0A" class="RktValLink" pltdoc="x">cons</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">first-word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">second-word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgbW9kdWxlKykpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">module+</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">main</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZGVmaW5lKSkp%0D%0A" class="RktStxLink" pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">words</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9tb3JlLXNjaGVtZS5ya3QiKSBjIHRpbWUpKSk%3D%0D%0A" class="RktStxLink" pltdoc="x">time</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">word-combinations</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBw%0D%0AcmludGYpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">printf</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"There</span><span class="hspace">&nbsp;</span><span class="RktVal">are</span><span class="hspace">&nbsp;</span><span class="RktVal">~a</span><span class="hspace">&nbsp;</span><span class="RktVal">words.\n"</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBs%0D%0AZW5ndGgpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">length</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">words</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Print</span><span class="hspace">&nbsp;</span><span class="RktCmt">a</span><span class="hspace">&nbsp;</span><span class="RktCmt">random</span><span class="hspace">&nbsp;</span><span class="RktCmt">subset</span><span class="hspace">&nbsp;</span><span class="RktCmt">of</span><span class="hspace">&nbsp;</span><span class="RktCmt">the</span><span class="hspace">&nbsp;</span><span class="RktCmt">results.</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyB3%0D%0Acml0ZSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">write</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9saXN0LnJr%0D%0AdCIpIGMgdGFrZSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">take</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9saXN0LnJr%0D%0AdCIpIGMgc2h1ZmZsZSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">shuffle</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">words</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBu%0D%0AZXdsaW5lKSkp%0D%0A" class="RktValLink" pltdoc="x">newline</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote><p><div class="SIntrapara">There are definitely better ways to do this. We naively loop through the
dictionary for each dictionary word and see if the concatenation is also part
of the dictionary&ndash;an O(n&#178;) operation assuming constant <span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9zZXQucmt0%0D%0AIikgYyBzZXQtbWVtYmVyPykpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">set-member?</a></span>
time. As written, this code is an ideal candidate for parallelization:
</div><div class="SIntrapara"><ul><li><p>We can split up the outer loop of this dictionary search into
parts</p></li><li><p>Each iteration of the outer loop doesn&rsquo;t depend on any other iteration; each is <span style="font-weight: bold">&ldquo;self-contained&rdquo;</span></p></li><li><p>There isn&rsquo;t very much processing to do after we have the word list</p></li></ul></div></p><p><div class="SIntrapara">Running this on an Intel Xeon 1.86GHz CPU produced this output:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">cpu time: 11233134 real time: 11231587 gc time: 103748</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">There are 17658 words.</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">(("for" . "going") ("tail" . "gating") ("minima" . "list's") ("wise" . "acres") ("mill" . "stone's") ("hare" . "brained") ("under" . "bids") ("Chi" . "lean") ("clod" . "hopper") ("reap" . "points") ("dis" . "missal's") ("scholars" . "hip's") ("over" . "load") ("kilo" . "watts") ("trash" . "cans") ("snaps" . "hot") ("lattice" . "work") ("mast" . "head") ("over" . "coming") ("whole" . "sales"))</span></span></p></td></tr></table></div><div class="SIntrapara">We can see that it took 187.2 minutes.</div></p><p><div class="SIntrapara">To parallelize this code, I made three changes:
</div><div class="SIntrapara"><ul><li><p>I changed the outer <span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZm9yL2xpc3QpKSk%3D%0D%0A" class="RktStxLink" pltdoc="x">for/list</a></span> form to a
<span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> form</p></li><li><p>I added a <span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">connect-to-riot-server!</span></span></span><span class="RktPn">)</span> call in the main submodule</p></li><li><p>I ran twenty total workers on four spare lab machines and started the
tracker server on <span class="stt">alfred</span></p></li></ul></div></p><p><div class="SIntrapara">The new code looks like this:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgbW9kLXBhdGggYyAicmFja2V0Iikp%0D%0A" class="RktModLink" pltdoc="x"><span class="RktSym">racket</span></a><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">dict.rkt</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcGxhbmV0KSkp%0D%0A" class="RktStxLink" pltdoc="x">planet</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">gcr/riot</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZGVmaW5lKSkp%0D%0A" class="RktStxLink" pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">List</span><span class="hspace">&nbsp;</span><span class="RktCmt">of</span><span class="hspace">&nbsp;</span><span class="RktCmt">words</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvc2V0LnJr%0D%0AdCIpIGMgZm9yL3NldCkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">for/set</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9wcml2YXRl%0D%0AL2Jhc2Uucmt0IikgYyBpbi1saXN0KSkp%0D%0A" class="RktValLink" pltdoc="x">in-list</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9maWxlLnJr%0D%0AdCIpIGMgZmlsZS0%2BbGluZXMpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">file-&gt;lines</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"/usr/share/dict/words"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">#:when</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyA%2B%0D%0APSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">&gt;=</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBz%0D%0AdHJpbmctbGVuZ3RoKSkp%0D%0A" class="RktValLink" pltdoc="x">string-length</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZGVmaW5lKSkp%0D%0A" class="RktStxLink" pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">word-combinations</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9wcml2YXRl%0D%0AL2Jhc2Uucmt0IikgYyBhcHBseSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">apply</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBh%0D%0AcHBlbmQpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">append</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;</span><span class="hspace">&nbsp;</span><span class="RktCmt">This</span><span class="hspace">&nbsp;</span><span class="RktCmt">flattens</span><span class="hspace">&nbsp;</span><span class="RktCmt">the</span><span class="hspace">&nbsp;</span><span class="RktCmt">list</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">first-word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9zZXQucmt0%0D%0AIikgYyBpbi1zZXQpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">in-set</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZm9yL2xpc3QpKSk%3D%0D%0A" class="RktStxLink" pltdoc="x">for/list</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">second-word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9zZXQucmt0%0D%0AIikgYyBpbi1zZXQpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">in-set</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">#:when</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9zZXQucmt0%0D%0AIikgYyBzZXQtbWVtYmVyPykpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">set-member?</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">dictionary</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBz%0D%0AdHJpbmctYXBwZW5kKSkp%0D%0A" class="RktValLink" pltdoc="x">string-append</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">first-word</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">second-word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBj%0D%0Ab25zKSkp%0D%0A" class="RktValLink" pltdoc="x">cons</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">first-word</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">second-word</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgbW9kdWxlKykpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">module+</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">main</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">connect-to-riot-server!</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"alfred"</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgZGVmaW5lKSkp%0D%0A" class="RktStxLink" pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">words</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9tb3JlLXNjaGVtZS5ya3QiKSBjIHRpbWUpKSk%3D%0D%0A" class="RktStxLink" pltdoc="x">time</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">word-combinations</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBw%0D%0AcmludGYpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">printf</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"There</span><span class="hspace">&nbsp;</span><span class="RktVal">are</span><span class="hspace">&nbsp;</span><span class="RktVal">~a</span><span class="hspace">&nbsp;</span><span class="RktVal">words.\n"</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBs%0D%0AZW5ndGgpKSk%3D%0D%0A" class="RktValLink" pltdoc="x">length</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">words</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Print</span><span class="hspace">&nbsp;</span><span class="RktCmt">a</span><span class="hspace">&nbsp;</span><span class="RktCmt">random</span><span class="hspace">&nbsp;</span><span class="RktCmt">subset</span><span class="hspace">&nbsp;</span><span class="RktCmt">of</span><span class="hspace">&nbsp;</span><span class="RktCmt">the</span><span class="hspace">&nbsp;</span><span class="RktCmt">results.</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyB3%0D%0Acml0ZSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">write</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9saXN0LnJr%0D%0AdCIpIGMgdGFrZSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">take</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgbGliIGMgInJhY2tldC9saXN0LnJr%0D%0AdCIpIGMgc2h1ZmZsZSkpKQ%3D%3D%0D%0A" class="RktValLink" pltdoc="x">shuffle</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">words</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZGVmIGMgKGMgKGMgcXVvdGUgYyAjJWtlcm5lbCkgYyBu%0D%0AZXdsaW5lKSkp%0D%0A" class="RktValLink" pltdoc="x">newline</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></div></p><p><div class="SIntrapara">This program generates this output:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ ~/racket/bin/racket dict.rkt</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">cpu time: 51903 real time: 1121990 gc time: 1732</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">There are 17658 words.</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">(("nick" . "name's") ("head" . "lights") ("ran" . "sacks") ("disc" . "lose") ("build" . "ups") ("wind" . "breaks") ("hot" . "headed") ("god" . "parent") ("main" . "frame") ("fiddle" . "sticks") ("pro" . "verbs") ("Volta" . "ire") ("select" . "ions") ("trail" . "blazer") ("bat" . "ten's") ("sniff" . "led") ("over" . "joys") ("down" . "hill") ("panel" . "led") ("tempera" . "ting"))</span></span></p></td></tr></table></div></p><p>This version took 18.7 minutes, which is a factor of 10 improvement. We still
found all 17658 compound words because <span class="stt">/usr/share/dict/words</span> is the same
on all machines.</p><p><div class="SIntrapara">Running the program a second time...
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ ~/racket/bin/racket dict.rkt</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">cpu time: 30133 real time: 63214 gc time: 772</span></span></p></td></tr></table></div><div class="SIntrapara">...took 63 seconds because the tracker remembered the 100,000 completed
workunits so the program spent all of its time in network traffic and
appending/shuffling the huge list of results.</div></p><h3>4<tt>&nbsp;</tt><a name="(part._.In_which_we_present_an_overview_and_clarity_is_achieved)"></a>In which we present an overview and clarity is achieved</h3><p><div class="SIntrapara">Riot clusters consist of three parts:
</div><div class="SIntrapara"><ul><li><p>A <span style="font-weight: bold">master program</span></p></li><li><p>A <span style="font-weight: bold">tracker</span> server</p></li><li><p>One or more <span style="font-weight: bold">worker processeses</span></p></li></ul></div></p><h4>4.1<tt>&nbsp;</tt><a name="(part._.The_master_program)"></a>The master program</h4><p>The master program sends workunits to the tracker and waits for the tracker to
send results back.</p><h4>4.2<tt>&nbsp;</tt><a name="(part._.The_tracker)"></a><a name="(mod-path._(planet._gcr/riot~3a1~3a~3d0/server))"></a>The tracker</h4><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcGxhbmV0KSkp%0D%0A" class="RktStxLink" pltdoc="x">planet</a></span><span class="stt"> </span><span class="RktSym">gcr/riot:1:=0/server</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">The tracker server&rsquo;s only job is to accept workunits from master programs,
assign them to workers, and return worker results back to the master program.
It&rsquo;s essentially nothing more than a database of workunits. You can query that
database using the functions described in the <a href="/#(part._lowlevel)" pltdoc="x">low-level
client API section</a>.</div></p><p><div class="SIntrapara">To start your own tracker server, run:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ racket -p gcr/riot/server</span></span></p></td></tr></table></div><div class="SIntrapara">The server can also run on a different port, like this:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ racket -p gcr/riot/server -- --port 12345</span></span></p></td></tr></table></div><div class="SIntrapara">The <span class="stt"></span><span class="stt">&ndash;</span><span class="stt"></span> separates racket&rsquo;s commandline arguments from the server&rsquo;s.</div></p><h4>4.3<tt>&nbsp;</tt><a name="(part._.The_workers)"></a><a name="(mod-path._(planet._gcr/riot~3a1~3a~3d0/worker))"></a>The workers</h4><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcGxhbmV0KSkp%0D%0A" class="RktStxLink" pltdoc="x">planet</a></span><span class="stt"> </span><span class="RktSym">gcr/riot:1:=0/worker</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara"><p><div class="SIntrapara">Workers are processes that do work. You can start them by running:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">racket -p gcr/riot/worker -- --port 1234 --name worker-name server-host</span></span></p></td></tr></table></div><div class="SIntrapara">where <span class="stt"></span><span class="stt">&ndash;</span><span class="stt">port</span> and <span class="stt"></span><span class="stt">&ndash;</span><span class="stt">name</span> are optional.</div></p></div><div class="SIntrapara">Each worker has a &ldquo;client name&rdquo; that identifies itself. This defaults to the
machine&rsquo;s hostname followed by a dash and a random string of consonants. To
change this, use <span class="stt"></span><span class="stt">&ndash;</span><span class="stt">name</span>.</div><div class="SIntrapara"><p><div class="SIntrapara">In workunits created by <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> and <span class="RktSym"><span class="badlink"><span class="RktValLink">do-work</span></span></span>, each worker
will <span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span> the module that contains that form. In the case of
<span class="RktSym"><span class="badlink"><span class="RktValLink">do-work/call</span></span></span> workunits, the worker will <span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span> the module
named by the <span class="RktSym"><span class="badlink"><span class="RktValLink">do-work/call</span></span></span> form. To be sure that the worker can find
the module, you must run the worker in the same directory that you ran the
master program relative to the module. For example, if you ran:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ cd /tmp/demo; racket simple-demo.rkt</span></span></p></td></tr></table></div><div class="SIntrapara">on the master and copied <span class="stt">simple-demo.rkt</span> to
<span class="RktVal">"/home/worker/demo/simple-demo.rkt"</span> on the worker, you must run the
worker like this:
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">$ cd /home/worker/demo; racket -p gcr/riot/worker -- tracker-server</span></span></p></td></tr></table></div></p></div><div class="SIntrapara">This also means that each worker must have identical copies of
<span class="stt">simple-demo.rkt</span>. If the body of a worker&rsquo;s <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> form does not
exactly match the master&rsquo;s <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> form, it will complain about a
code mismatch. The <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> and <span class="RktSym"><span class="badlink"><span class="RktValLink">do-work</span></span></span> forms check for this,
but <span class="RktSym"><span class="badlink"><span class="RktValLink">do-work/call</span></span></span> cannot check the version of the module it requires,
so workers with differing versions of those modules will silently misbehave.</div><div class="SIntrapara">A worker shouldn&rsquo;t generate its own workunits; it should only run work. This
means you musn&rsquo;t use <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> or <span class="RktSym"><span class="badlink"><span class="RktValLink">do-work</span></span></span> forms in the
toplevel (or in any function that runs when the module is required) or else
your workers will attempt to generate workunits of their own! See the
<a href="/#(part._restrictions)" pltdoc="x">for/work section</a> for more details.</div></p><h3>5<tt>&nbsp;</tt><a name="(part._restrictions)"></a><a name="(mod-path._(planet._gcr/riot~3a1~3a~3d0))"></a>In which we dispel all manner of shenanigans and peculiarities about for/work and do-work</h3><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcmVxdWlyZSkpKQ%3D%3D%0D%0A" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKGMgZm9ybSBjIChjIChjIGxpYiBjICJyYWNrZXQvcHJpdmF0%0D%0AZS9iYXNlLnJrdCIpIGMgcGxhbmV0KSkp%0D%0A" class="RktStxLink" pltdoc="x">planet</a></span><span class="stt"> </span><span class="RktSym">gcr/riot:1:=0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">...</div></p><h3>6<tt>&nbsp;</tt><a name="(part._.In_which_we_describe_the_numerous_kinds_of_workunits)"></a>In which we describe the numerous kinds of workunits</h3><p>There&rsquo;s more to riot than <span class="RktSym"><span class="badlink"><span class="RktValLink">for/work</span></span></span> and <span class="RktSym"><span class="badlink"><span class="RktValLink">do-work</span></span></span>.</p><p>do-work/call
- Takes a module path
- Still must restart workers
do-work/eval
- Can use from the REPL
- Only one where the workers don&rsquo;t require any extra code</p><h3>7<tt>&nbsp;</tt><a name="(part._lowlevel)"></a>In which we present a lower-level client API for communicating with the tracker</h3><p>- Example: Something useful, but slow</p><p>- Concepts
  Master program picks work and farms it to the queue server. Master divides
  work into "workunits"; discrete pieces that don&rsquo;t depend on each other.
  Queue server keeps track of all pending, completed, and failed workunits.
  Queue server assigns workunits to workers and sends workunits back to the
  master when they&rsquo;re done. The queue server also caches completed workunits so
  the task can be restarted quickly if things break. Currently, the queue
  server just keeps all of this in memory which is bad.
  - Master
  - Queue server, how to run
  - Workers, how to run</p><p>- The many ways of running workunits</p><p>Constraints on (do-work) and (for/work):
- Must be in its own file; won&rsquo;t work from toplevel.</p><p>- All variables that the body refers to must be serializable. This
  means using serialize-struct instead of normal struct()s. Also,
  careful about referring to big variables that change.</p><p>- Related: When workers attempt to execute a workunit created by a
  do-work form, they (require) the module and search for the code to be
  executed. This has a number of implications:</p><p>- Be sure not to run this code in the toplevel, or else your workers will try
    to create workunits of their own!</p><p>- If you&rsquo;re running workers on other machines accross a network, the
    module you&rsquo;re running must be present on all of the worker machines.</p><p>- You must start the worker process in the same working directory
    relative to your master, so each of the workers can find the module.
    For example, if test.rkt lives in /home/michael/project/test.rkt on
    the master machine and in /tmp/project/test.rkt on the workers, you
    must start your racket process like this on the master:
    cd /home/michael/project; racket test.rkt
    and this on the workers:
    cd /tmp/project; racket -p gcr/riot/worker</p><p>- If you change the code, you must copy the module to each of the
    worker machines in turn and restart the workers.</p><p>- Lower-level client API</p><p>&#8212;<wbr></wbr>&#8212;<wbr></wbr>-
#lang racket
(require (planet gcr/riot))</p><p>(define dictionary
  (for/set ([word (in-list (file-&gt;lines "/usr/share/dict/words"))]
            #:when (&gt;= (string-length word) 3))
           word))</p><p>(define (word-combinations)
   (apply append ;; This flattens the list
          (for/work ([first-word (in-set dictionary)])
            (for/list ([second-word (in-set dictionary)]
                       #:when (set-member? dictionary
                                           (string-append first-word
                                                          second-word)))
              (printf "Found ~s-~s\n" first-word second-word)
              (flush-output)
              (cons first-word second-word)))))</p><p>(module+ main
  (connect-to-riot-server! "localhost")
  (define words (time (word-combinations)))
  (printf "There are ~a words.\n" (length words))
  (write (take (shuffle words) 20))
  (newline))</p><p>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&ndash;</p><p>With ???? workers, I get 105 workunits per second.
9 workers on alfred (running queue server),
3 jarvis,
4 lurch,
4 kato,</p><p>= 20 total.</p><p>The second time:
$ ~/racket/bin/racket dict.rkt
cpu time: 30133 real time: 63214 gc time: 772</p><p>Without riot:</p></div></div><div id="contextindicator">&nbsp;</div></body></html>